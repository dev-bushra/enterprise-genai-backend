# ุงุณุชุฎุฏุงู RBAC ุฏุงุฎู API
# ูุฐุง ุงูููู ูุญุชูู ุฑุงูุชุฑ API ูุน ุฑุงูุชุงุช ูุญููุฉ ุจุงุณุชุฎุฏุงู ูุธุงู RBAC ููุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ูุจู ุงูุณูุงุญ ุจุงูุฏุฎูู.

from fastapi import (
    APIRouter,
    Depends,
)  # ุงุณุชูุฑุงุฏ APIRouter ูุฅูุดุงุก ูุฌููุนุฉ ูู ุงูุฑุงูุชุงุช ู Depends ูุฅุฏุงุฑุฉ ุงูุงุนุชูุงุฏูุฉ
from app.auth.deps import require_roles  # ุงุณุชูุฑุงุฏ ุฏุงูุฉ ุชุญูู ุงูุฃุฏูุงุฑ (RBAC) ูู auth.deps

router = APIRouter()  # ุฅูุดุงุก ุฑุงูุชุฑ ูุณุชูู ูุชุฌููุน ุฑุงูุชุงุช ุงูููุงู


@router.get("/admin-only")  # ุฑุงูุช GET ูุญููุ ูุชุงุญ ููุท ูููุฏูุฑูู
async def admin_data(
    user=Depends(require_roles(["admin"])),
):  # ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุจุนุฏ ุงูุชุญูู ูู ุฏูุฑู "admin"
    return {"msg": "ูุฐุง ูุญุชูู ุฎุงุต ุจุงููุฏูุฑูู ููุท!"}  # ุฑุฏ ุจุณูุท ูุคูุฏ ุตูุงุญูุฉ ุงูุฏุฎูู


@router.get("/viewer-or-admin")  # ุฑุงูุช GET ูุชุงุญ ูููุฏูุฑูู ุฃู ุงููุดุงูุฏูู ููุท
async def open_data(
    user=Depends(require_roles(["admin", "viewer"]))
):  # ูุญูู ุงููุณุชุฎุฏู ุจุนุฏ ุงูุชุฃูุฏ ูู ุงูุฏูุฑ ุงูููุงุณุจ
    return {
        "msg": "ุฃูุช ูุฏูู ุตูุงุญูุฉ ุงููุดุงูุฏุฉ ุฃู ุงูุฅุฏุงุฑุฉ ๐"
    }  # ุฑุฏ ุจุณูุท ููุถุญ ุงููุตูู ุงููุณููุญ
